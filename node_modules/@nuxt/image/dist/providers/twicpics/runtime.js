"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("~image/utils");
const fits = utils_1.createMapper({
    fill: 'fill',
    inside: 'pad',
    outside: 'lpad',
    cover: 'cover',
    contain: 'contain',
    missingValue: 'cover'
});
const operationsGenerator = utils_1.createOperationsGenerator({
    keyMap: {
        format: 'format'
    },
    joinWith: '/',
    formatter: (key, value) => `${key}=${value}`
});
exports.default = {
    getImage(src, modifiers, options) {
        const { width, height, fit, ...providerModifiers } = modifiers;
        if (width || height) {
            providerModifiers[fits(fit)] = `${width || '-'}x${height || '-'}`;
        }
        const operations = operationsGenerator(providerModifiers);
        return {
            url: utils_1.cleanDoubleSlashes(options.baseURL + src + '?twic=v1/' + operations)
        };
    }
};
