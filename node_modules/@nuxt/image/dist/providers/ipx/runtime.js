"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("~image/utils");
function predictAdapter(src) {
    return src.match(/^https?:\/\//) ? 'remote' : 'local';
}
exports.default = {
    getImage(src, modifiers, _options) {
        const operations = [];
        const fit = modifiers.fit ? `_${modifiers.fit}` : '';
        if (modifiers.width && modifiers.height) {
            operations.push(`s_${modifiers.width}_${modifiers.height}${fit}`);
        }
        else if (modifiers.width) {
            operations.push(`w_${modifiers.width}${fit}`);
        }
        else if (modifiers.height) {
            operations.push(`h_${modifiers.height}${fit}`);
        }
        const adapter = predictAdapter(src);
        const operationsString = operations.join(',') || '_';
        const url = utils_1.cleanDoubleSlashes(`/_image/ipx/${adapter}/${modifiers.format || '_'}/${operationsString}/${src}`);
        return {
            url,
            isStatic: true
        };
    }
};
